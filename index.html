<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iuran Kelas - Jadwal & Progress</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .header-info {
            font-size: 1.1em;
            line-height: 1.8;
            opacity: 0.95;
        }

        .schedule-detail {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 20px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 1em;
            line-height: 1.6;
        }

        .content {
            padding: 30px;
        }

        .targets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .target-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .target-card.achieved {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .target-card h3 {
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        .target-card p {
            font-size: 1.05em;
            line-height: 1.6;
            margin: 8px 0;
        }

        .target-card .badge {
            display: inline-block;
            background: rgba(255,255,255,0.3);
            padding: 5px 12px;
            border-radius: 20px;
            margin-top: 10px;
            font-weight: bold;
        }

        .summary-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }

        .summary-box h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .summary-box p {
            font-size: 1.1em;
            margin: 5px 0;
        }

        /* MONTH SECTION */
        .month-section {
            margin-bottom: 50px;
        }

        .month-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .month-header h2 {
            font-size: 1.8em;
            margin: 0;
        }

        .month-summary {
            text-align: right;
            font-size: 1.1em;
        }

        .month-summary div {
            margin: 5px 0;
        }

        .table-container {
            overflow-x: auto;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 10px;
            border-bottom: 1px solid #e9ecef;
        }

        tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tbody tr:hover {
            background-color: #e9ecef;
        }

        .row-minggu {
            background-color: #e9ecef !important;
            color: #6c757d;
        }

        .row-libur {
            background-color: #fff3cd !important;
        }

        .row-lunas {
            background-color: #d4edda !important;
            font-weight: 600;
        }

        .status-sekolah {
            color: #28a745;
            font-weight: 600;
        }

        .status-minggu {
            color: #6c757d;
        }

        .status-libur {
            color: #856404;
        }

        .keterangan-lunas {
            background: #28a745;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
            display: inline-block;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .header-info {
                font-size: 1em;
            }

            .content {
                padding: 15px;
            }

            .month-header {
                flex-direction: column;
                text-align: center;
            }

            .month-summary {
                text-align: center;
            }

            table {
                font-size: 0.85em;
            }

            th, td {
                padding: 8px 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Iuran Kelas ‚Äì Jadwal & Progress</h1>
            <div class="header-info">
                <p><strong>Setoran:</strong> Rp 5.000 per hari sekolah</p>
                <p><strong>Catatan:</strong> Minggu & libur sekolah tidak setor, tapi tetap tercatat</p>
            </div>
            <div class="schedule-detail">
                <strong>üìÖ Jadwal Iuran:</strong><br>
                Dimulai dari <strong>Jumat, 7 November 2025</strong> sampai <strong>Sabtu, 6 Desember 2025</strong>,<br>
                kemudian <strong>LIBUR</strong> tanggal 7 Desember 2025 - 4 Januari 2026,<br>
                dan dilanjutkan kembali mulai <strong>Senin, 5 Januari 2026</strong>.
            </div>
        </div>

        <div class="content">
            <h2 style="margin-bottom: 20px; color: #667eea;">üìä Target Iuran</h2>
            <div class="targets-grid" id="targetsGrid"></div>

            <div class="summary-box" id="summaryBox"></div>

            <h2 style="margin-bottom: 20px; color: #667eea;">üìÖ Tabel Iuran Per Bulan</h2>
            <div id="monthlyTables"></div>
        </div>
    </div>

    <script>
        // Konstanta
        const IURAN_HARIAN = 5000;
        const TANGGAL_MULAI = new Date(2025, 10, 7); // 7 November 2025
        const TANGGAL_AKHIR = new Date(2026, 0, 31); // 31 Januari 2026
        const LIBUR_MULAI = new Date(2025, 11, 7); // 7 Desember 2025
        const LIBUR_AKHIR = new Date(2026, 0, 4); // 4 Januari 2026

        const NAMA_HARI = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
        const NAMA_BULAN = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 
                           'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
        const TARGETS = [150000, 200000, 250000];

        // Fungsi helper
        function isSunday(date) {
            return date.getDay() === 0;
        }

        function isLibur(date) {
            return date >= LIBUR_MULAI && date <= LIBUR_AKHIR;
        }

        function getStatusHari(date) {
            if (isSunday(date)) {
                return { 
                    status: 'Minggu (tidak setor)', 
                    setoran: 0, 
                    cssClass: 'row-minggu', 
                    statusClass: 'status-minggu' 
                };
            }
            if (isLibur(date)) {
                return { 
                    status: 'Libur (tidak setor)', 
                    setoran: 0, 
                    cssClass: 'row-libur', 
                    statusClass: 'status-libur' 
                };
            }
            return { 
                status: 'Sekolah (bayar)', 
                setoran: IURAN_HARIAN, 
                cssClass: '', 
                statusClass: 'status-sekolah' 
            };
        }

        function formatTanggalLengkap(date) {
            const hari = NAMA_HARI[date.getDay()];
            const tanggal = date.getDate();
            const bulan = NAMA_BULAN[date.getMonth()];
            const tahun = date.getFullYear();
            return `${hari}, ${tanggal} ${bulan} ${tahun}`;
        }

        function formatRupiah(angka) {
            return angka.toLocaleString('id-ID');
        }

        // Generate data iuran
        function generateDataIuran() {
            const data = [];
            let currentDate = new Date(TANGGAL_MULAI);
            let totalTerkumpul = 0;
            let targetIndex = 0;
            const targetResults = [];

            while (currentDate <= TANGGAL_AKHIR) {
                const statusInfo = getStatusHari(currentDate);
                totalTerkumpul += statusInfo.setoran;

                let keterangan = '';
                let isLunas = false;

                // Check if target reached
                if (targetIndex < TARGETS.length && totalTerkumpul >= TARGETS[targetIndex]) {
                    keterangan = `LUNAS ${TARGETS[targetIndex] / 1000}k`;
                    isLunas = true;
                    targetResults.push({
                        target: TARGETS[targetIndex],
                        tanggal: new Date(currentDate),
                        totalTerkumpul: totalTerkumpul
                    });
                    targetIndex++;
                }

                data.push({
                    tanggalLengkap: formatTanggalLengkap(currentDate),
                    tanggalObj: new Date(currentDate),
                    hari: NAMA_HARI[currentDate.getDay()],
                    bulan: currentDate.getMonth(),
                    tahun: currentDate.getFullYear(),
                    status: statusInfo.status,
                    setoran: statusInfo.setoran,
                    totalTerkumpul: totalTerkumpul,
                    keterangan: keterangan,
                    cssClass: isLunas ? 'row-lunas' : statusInfo.cssClass,
                    statusClass: statusInfo.statusClass
                });

                currentDate.setDate(currentDate.getDate() + 1);
            }

            return { data, targetResults, totalTerkumpul };
        }

        // Group data by month
        function groupByMonth(data) {
            const grouped = {};
            data.forEach(item => {
                const key = `${item.tahun}-${item.bulan}`;
                if (!grouped[key]) {
                    grouped[key] = {
                        bulan: item.bulan,
                        tahun: item.tahun,
                        data: []
                    };
                }
                grouped[key].data.push(item);
            });
            return Object.values(grouped);
        }

        // Render target cards
        function renderTargetCards(targetResults) {
            const targetsGrid = document.getElementById('targetsGrid');
            
            TARGETS.forEach((target, index) => {
                const result = targetResults[index];
                const card = document.createElement('div');
                card.className = result ? 'target-card achieved' : 'target-card';
                
                if (result) {
                    // Hitung hari setor ke berapa
                    let hariSetorCount = 0;
                    let tempDate = new Date(TANGGAL_MULAI);
                    while (tempDate <= result.tanggal) {
                        const statusInfo = getStatusHari(tempDate);
                        if (statusInfo.setoran > 0) hariSetorCount++;
                        tempDate.setDate(tempDate.getDate() + 1);
                    }

                    card.innerHTML = `
                        <h3>Target Rp ${formatRupiah(target)}</h3>
                        <p>‚úÖ Hari setor ke-${hariSetorCount}</p>
                        <p>üìÖ ${formatTanggalLengkap(result.tanggal)}</p>
                        <p>üí∞ Total: Rp ${formatRupiah(result.totalTerkumpul)}</p>
                        <div class="badge">TERCAPAI</div>
                    `;
                } else {
                    card.innerHTML = `
                        <h3>Target Rp ${formatRupiah(target)}</h3>
                        <p>‚è≥ Belum tercapai dalam periode ini</p>
                    `;
                }
                
                targetsGrid.appendChild(card);
            });
        }

        // Render summary box
        function renderSummary(totalHariSetor, totalAkhir) {
            const summaryBox = document.getElementById('summaryBox');
            summaryBox.innerHTML = `
                <h3>üìà Ringkasan Periode</h3>
                <p><strong>Total hari setor:</strong> ${totalHariSetor} hari</p>
                <p><strong>Total terkumpul (per 31 Januari 2026):</strong> Rp ${formatRupiah(totalAkhir)}</p>
            `;
        }

        // Render monthly tables
        function renderMonthlyTables(monthlyData) {
            const container = document.getElementById('monthlyTables');
            
            monthlyData.forEach(month => {
                const monthSection = document.createElement('div');
                monthSection.className = 'month-section';
                
                // Hitung summary bulan ini
                const hariSetor = month.data.filter(d => d.setoran > 0).length;
                const totalBulan = month.data[month.data.length - 1].totalTerkumpul - 
                                  (month.data[0].totalTerkumpul - month.data[0].setoran);
                
                monthSection.innerHTML = `
                    <div class="month-header">
                        <h2>üìÖ ${NAMA_BULAN[month.bulan]} ${month.tahun}</h2>
                        <div class="month-summary">
                            <div><strong>${hariSetor}</strong> hari setor</div>
                            <div>Rp <strong>${formatRupiah(totalBulan)}</strong> terkumpul</div>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Hari</th>
                                    <th>Status Hari</th>
                                    <th>Setoran</th>
                                    <th>Total Terkumpul</th>
                                    <th>Keterangan</th>
                                </tr>
                            </thead>
                            <tbody id="month-${month.bulan}-${month.tahun}"></tbody>
                        </table>
                    </div>
                `;
                
                container.appendChild(monthSection);
                
                // Render rows
                const tbody = document.getElementById(`month-${month.bulan}-${month.tahun}`);
                month.data.forEach((item, index) => {
                    const row = document.createElement('tr');
                    row.className = item.cssClass;
                    
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${item.tanggalLengkap}</td>
                        <td>${item.hari}</td>
                        <td class="${item.statusClass}">${item.status}</td>
                        <td>Rp ${formatRupiah(item.setoran)}</td>
                        <td><strong>Rp ${formatRupiah(item.totalTerkumpul)}</strong></td>
                        <td>${item.keterangan ? `<span class="keterangan-lunas">${item.keterangan}</span>` : ''}</td>
                    `;
                    
                    tbody.appendChild(row);
                });
            });
        }

        // Initialize
        function init() {
            const { data, targetResults, totalTerkumpul } = generateDataIuran();
            const monthlyData = groupByMonth(data);
            
            // Hitung total hari setor
            const totalHariSetor = data.filter(item => item.setoran > 0).length;
            
            renderTargetCards(targetResults);
            renderSummary(totalHariSetor, totalTerkumpul);
            renderMonthlyTables(monthlyData);
        }

        // Run on page load
        init();
    </script>
</body>
</html>